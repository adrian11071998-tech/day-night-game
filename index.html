<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ç™½å¤© / é»‘å¤œï¼šæ‹–æ‹‰é…å°å°éŠæˆ²</title>
  <style>
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --text:#1b1f2a;
      --muted:#5a6475;
      --ok:#1e8e3e;
      --bad:#c62828;
      --shadow: 0 10px 22px rgba(10,20,40,.10);
      --radius: 18px;
    }
    body{
      margin:0;
      font-family: system-ui, -apple-system, "PingFang TC", "Microsoft JhengHei", "Noto Sans TC", Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
    }
    .wrap{
      max-width: 980px;
      margin: 18px auto;
      padding: 14px;
    }
    header{
      display:flex;
      gap:12px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
      margin-bottom: 12px;
    }
    .title{
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px 16px;
      flex:1 1 520px;
      min-width: 280px;
    }
    .title h1{
      margin:0 0 6px 0;
      font-size: 22px;
      letter-spacing: .5px;
    }
    .title p{
      margin:0;
      color: var(--muted);
      font-size: 16px;
      line-height: 1.35;
    }
    .panel{
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px 16px;
      flex:0 0 auto;
      min-width: 280px;
    }
    .row{
      display:flex;
      gap: 14px;
      flex-wrap: wrap;
      align-items: stretch;
    }
    .sceneCard{
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px;
      flex: 1 1 560px;
      min-width: 320px;
    }
    .toolsCard{
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px;
      flex: 1 1 320px;
      min-width: 280px;
    }

    .sceneTop{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-bottom: 10px;
    }
    .badge{
      font-size: 16px;
      padding: 8px 10px;
      border-radius: 999px;
      background:#eef2ff;
      color:#27307a;
      font-weight: 700;
    }
    .counter{
      font-size: 16px;
      color: var(--muted);
      font-weight: 700;
    }

    /* Scene canvas */
    .canvas{
      position: relative;
      width: 100%;
      aspect-ratio: 16 / 10;
      border-radius: 16px;
      overflow: hidden;
      border: 2px solid rgba(0,0,0,.08);
      background: #ddd;
      touch-action: none;
      user-select: none;
    }
    .canvas svg{
      width:100%;
      height:100%;
      display:block;
    }

    /* Drop zones (invisible but highlighted on hover) */
    .dropzone{
      position:absolute;
      border-radius: 999px;
      outline: 0;
      border: 3px dashed rgba(255,255,255,.0);
      background: rgba(255,255,255,.0);
      transition: .12s ease;
    }
    .dropzone.active{
      border-color: rgba(255,255,255,.85);
      background: rgba(255,255,255,.10);
    }
    .dropzone.filled{
      border-color: rgba(30,142,62,.0);
      background: rgba(30,142,62,.0);
    }

    /* Placed items inside scene */
    .placed{
      position:absolute;
      font-size: 46px;
      transform: translate(-50%, -50%);
      pointer-events: none;
      filter: drop-shadow(0 4px 4px rgba(0,0,0,.18));
    }

    /* Draggables */
    .toolTitle{
      margin:0 0 10px 0;
      font-size: 18px;
    }
    .toolHint{
      margin:0 0 10px 0;
      color: var(--muted);
      font-size: 15px;
      line-height:1.35;
    }
    .toolRow{
      display:flex;
      gap: 12px;
      flex-wrap:wrap;
      margin-top: 10px;
    }
    .draggable{
      width: 92px;
      height: 92px;
      display:grid;
      place-items:center;
      font-size: 54px;
      border-radius: 18px;
      border: 2px solid rgba(0,0,0,.10);
      background: #fff;
      box-shadow: 0 6px 14px rgba(10,20,40,.10);
      cursor: grab;
      touch-action: none;
      user-select: none;
    }
    .draggable:active{ cursor: grabbing; transform: scale(.98); }
    .draggable.disabled{
      opacity: .35;
      pointer-events: none;
    }

    /* Buttons + feedback */
    .controls{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      margin-top: 12px;
      align-items:center;
      justify-content: space-between;
    }
    button{
      border:0;
      border-radius: 14px;
      padding: 12px 14px;
      font-size: 18px;
      font-weight: 800;
      cursor:pointer;
      box-shadow: 0 10px 18px rgba(10,20,40,.10);
    }
    .btnPrimary{ background:#1a73e8; color:#fff; }
    .btnGhost{ background:#eef2f7; color:#1b1f2a; }
    .btnPrimary:disabled{
      opacity: .5;
      cursor: not-allowed;
    }
    .feedback{
      margin-top: 10px;
      font-size: 18px;
      font-weight: 900;
      padding: 12px 14px;
      border-radius: 14px;
      display:none;
    }
    .feedback.ok{ display:block; background: rgba(30,142,62,.12); color: var(--ok); }
    .feedback.bad{ display:block; background: rgba(198,40,40,.10); color: var(--bad); }

    .mini{
      font-size: 14px;
      color: var(--muted);
      line-height:1.35;
      margin-top: 8px;
    }

    /* Big touch targets on small screens */
    @media (max-width: 560px){
      .draggable{ width: 84px; height: 84px; font-size: 50px; }
      .placed{ font-size: 42px; }
      button{ width: 100%; }
      .controls{ justify-content: stretch; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>ç™½å¤© / é»‘å¤œï¼šæ‹–æ‹‰é…å°</h1>
        <p>æŠŠæ­£ç¢ºçš„åœ–æ¡ˆæ”¾åˆ°ç›¸ç‰‡ä¸Šï¼š<b>ç™½å¤© â†’ å¤ªé™½</b>ï¼›<b>é»‘å¤œ â†’ æ˜Ÿæ˜Ÿ + æœˆäº®</b>ã€‚</p>
        <div class="mini">ï¼ˆé©åˆå°ä¸€ãƒ»è¼•åº¦æ™ºéšœå­¸ç”Ÿï¼šæ¯é¡Œåªè¦æ‹–æ‹‰ã€æ”¾ä¸‹ï¼Œç­”å°æœƒè‡ªå‹•åˆ°ä¸‹ä¸€é¡Œã€‚ï¼‰</div>
      </div>

      <div class="panel" aria-live="polite">
        <div style="display:flex;gap:10px;align-items:center;justify-content:space-between;">
          <div><b>é€²åº¦</b></div>
          <div id="score" style="font-weight:900;">0 / 0</div>
        </div>
        <div class="mini" id="goalText">ç›®æ¨™ï¼šè¾¨èªç™½å¤©å’Œé»‘å¤œçš„ç‰¹å¾µã€‚</div>
      </div>
    </header>

    <div class="row">
      <section class="sceneCard">
        <div class="sceneTop">
          <div class="badge" id="sceneLabel">é¡Œç›®</div>
          <div class="counter" id="counter">ç¬¬ 1 é¡Œ</div>
        </div>

        <div class="canvas" id="canvas" role="application" aria-label="ç›¸ç‰‡å€åŸŸï¼ˆæŠŠåœ–æ¡ˆæ‹–åˆ°ç›¸ç‰‡ä¸Šï¼‰">
          <!-- Background SVG injected here -->
          <div class="dropzone" id="dzSun"   data-accept="sun"   aria-label="å¤ªé™½ä½ç½®"></div>
          <div class="dropzone" id="dzMoon"  data-accept="moon"  aria-label="æœˆäº®ä½ç½®"></div>
          <div class="dropzone" id="dzStar"  data-accept="star"  aria-label="æ˜Ÿæ˜Ÿä½ç½®"></div>
          <!-- placed items -->
          <div class="placed" id="placedSun"  style="display:none;">â˜€ï¸</div>
          <div class="placed" id="placedMoon" style="display:none;">ğŸŒ™</div>
          <div class="placed" id="placedStar" style="display:none;">â­</div>
        </div>

        <div class="controls">
          <button class="btnGhost" id="btnReset" type="button">é‡è¨­æœ¬é¡Œ</button>
          <button class="btnPrimary" id="btnCheck" type="button">æª¢æŸ¥ç­”æ¡ˆ</button>
        </div>

        <div class="feedback" id="feedback"></div>
      </section>

      <aside class="toolsCard">
        <h2 class="toolTitle">å¯æ‹–æ‹‰çš„åœ–æ¡ˆ</h2>
        <p class="toolHint" id="toolHint">æç¤ºï¼šå¦‚æœæ˜¯ç™½å¤©ï¼Œåªè¦æ”¾ <b>å¤ªé™½</b>ã€‚å¦‚æœæ˜¯é»‘å¤œï¼Œè¦æ”¾ <b>æœˆäº®</b> å’Œ <b>æ˜Ÿæ˜Ÿ</b>ã€‚</p>

        <div class="toolRow">
          <div class="draggable" id="toolSun"  data-type="sun"  draggable="true" aria-label="å¤ªé™½">â˜€ï¸</div>
          <div class="draggable" id="toolMoon" data-type="moon" draggable="true" aria-label="æœˆäº®">ğŸŒ™</div>
          <div class="draggable" id="toolStar" data-type="star" draggable="true" aria-label="æ˜Ÿæ˜Ÿ">â­</div>
        </div>

        <div class="mini" style="margin-top:12px;">
          è€å¸«å°è²¼å£«ï¼šä½ å¯ä»¥åœ¨èª²å ‚æŠ•å½±ï¼Œè®“å­¸ç”Ÿè¼ªæµä¸Šä¾†æ‹–æ‹‰ï¼›æˆ–ç”¨å¹³æ¿ï¼è§¸æ§è¢å¹•æ“ä½œã€‚
        </div>

        <div style="margin-top:14px;display:flex;gap:10px;flex-wrap:wrap;">
          <button class="btnGhost" id="btnPrev" type="button">ä¸Šä¸€é¡Œ</button>
          <button class="btnGhost" id="btnNext" type="button">ä¸‹ä¸€é¡Œ</button>
        </div>
      </aside>
    </div>
  </div>

<script>
/** ===========
 *  1) é¡Œåº«è¨­å®š
 *  - type: 'day' æˆ– 'night'
 *  - bg: èƒŒæ™¯ SVGï¼ˆç”¨ã€Œç›¸ç‰‡æ„Ÿã€çš„ç°¡å–®æ’ç•«ï¼‰
 *  - drop zones ä½ç½®ï¼šç”¨ç™¾åˆ†æ¯”å®šä½ï¼ˆleft/top/sizeï¼‰
 * ============ */
const questions = [
  { type:'day',   label:'ç›¸ç‰‡ï¼šç™½å¤©',   bg: svgDay(1) },
  { type:'night', label:'ç›¸ç‰‡ï¼šé»‘å¤œ',   bg: svgNight(1) },
  { type:'day',   label:'ç›¸ç‰‡ï¼šç™½å¤©',   bg: svgDay(2) },
  { type:'night', label:'ç›¸ç‰‡ï¼šé»‘å¤œ',   bg: svgNight(2) },
  { type:'day',   label:'ç›¸ç‰‡ï¼šç™½å¤©',   bg: svgDay(3) },
  { type:'night', label:'ç›¸ç‰‡ï¼šé»‘å¤œ',   bg: svgNight(3) },
];

// ä½ å¯æ”¹ç‚ºæ›´å¤š / æ›´å°‘é¡Œ
const TOTAL = questions.length;

let idx = 0;
let correctCount = 0;

// æœ¬é¡Œç‹€æ…‹
let placed = { sun:false, moon:false, star:false };

const el = {
  canvas: document.getElementById('canvas'),
  sceneLabel: document.getElementById('sceneLabel'),
  counter: document.getElementById('counter'),
  score: document.getElementById('score'),
  feedback: document.getElementById('feedback'),
  btnCheck: document.getElementById('btnCheck'),
  btnReset: document.getElementById('btnReset'),
  btnPrev: document.getElementById('btnPrev'),
  btnNext: document.getElementById('btnNext'),
  toolHint: document.getElementById('toolHint'),

  dzSun: document.getElementById('dzSun'),
  dzMoon: document.getElementById('dzMoon'),
  dzStar: document.getElementById('dzStar'),

  placedSun: document.getElementById('placedSun'),
  placedMoon: document.getElementById('placedMoon'),
  placedStar: document.getElementById('placedStar'),

  toolSun: document.getElementById('toolSun'),
  toolMoon: document.getElementById('toolMoon'),
  toolStar: document.getElementById('toolStar'),
};

function setScore(){
  el.score.textContent = `${correctCount} / ${TOTAL}`;
}

function setFeedback(kind, text){
  el.feedback.className = `feedback ${kind}`;
  el.feedback.textContent = text;
}

function clearFeedback(){
  el.feedback.className = 'feedback';
  el.feedback.textContent = '';
}

function resetPlaced(){
  placed = { sun:false, moon:false, star:false };
  el.placedSun.style.display = 'none';
  el.placedMoon.style.display = 'none';
  el.placedStar.style.display = 'none';

  // å…è¨±å†æ¬¡æ‹–
  el.toolSun.classList.remove('disabled');
  el.toolMoon.classList.remove('disabled');
  el.toolStar.classList.remove('disabled');

  clearFeedback();
}

/** ===========
 * 2) è¨­å®šæœ¬é¡Œç•«é¢
 * ============ */
function loadQuestion(){
  const q = questions[idx];

  // èƒŒæ™¯ SVG
  // æŠŠ SVG æ”¾åˆ° canvas æœ€åº•å±¤
  // (dropzones / placed items åœ¨ä¸Šå±¤)
  const existing = el.canvas.querySelector('svg');
  if (existing) existing.remove();
  el.canvas.insertAdjacentHTML('afterbegin', q.bg);

  // é¡Œç›®æ¨™ç±¤
  el.sceneLabel.textContent = q.label;
  el.counter.textContent = `ç¬¬ ${idx+1} é¡Œ / ${TOTAL}`;

  // Dropzone ä½ç½®ï¼ˆç›¸ç‰‡å³ä¸Šåä¸Šã€é©åˆå­¸ç”Ÿï¼‰
  // ä½ å¯ä»¥æŒ‰éœ€è¦å¾®èª¿ left/top/size
  // ä»¥ canvas ç™¾åˆ†æ¯”å®šä½
  positionDropzones(q.type);

  // æ ¹æ“šé¡Œå‹é™åˆ¶å¯æ‹–åœ–æ¡ˆï¼ˆç™½å¤©åªç”¨å¤ªé™½ï¼›é»‘å¤œåªç”¨æœˆäº®+æ˜Ÿæ˜Ÿï¼‰
  if (q.type === 'day'){
    el.toolHint.innerHTML = 'é€™ä¸€å¼µæ˜¯ <b>ç™½å¤©</b>ã€‚è«‹æ”¾ <b>å¤ªé™½</b> â˜€ï¸ã€‚';
    enableTools({sun:true, moon:false, star:false});
  } else {
    el.toolHint.innerHTML = 'é€™ä¸€å¼µæ˜¯ <b>é»‘å¤œ</b>ã€‚è«‹æ”¾ <b>æœˆäº®</b> ğŸŒ™ å’Œ <b>æ˜Ÿæ˜Ÿ</b> â­ã€‚';
    enableTools({sun:false, moon:true, star:true});
  }

  resetPlaced();
  setScore();
}

function enableTools({sun, moon, star}){
  el.toolSun.style.display  = sun  ? 'grid' : 'none';
  el.toolMoon.style.display = moon ? 'grid' : 'none';
  el.toolStar.style.display = star ? 'grid' : 'none';
}

/** Dropzonesï¼šæˆ‘å€‘å›ºå®šä¸‰å€‹ä½ç½®ï¼Œä½†ç™½å¤©åªé¡¯ç¤ºå¤ªé™½å€ï¼›é»‘å¤œé¡¯ç¤ºæœˆäº®+æ˜Ÿæ˜Ÿå€ */
function positionDropzones(type){
  // ä½ç½®ï¼šç›¸ç‰‡å¤©ç©ºå³ä¸Š
  // ä½¿ç”¨ left/top/width/height (ç™¾åˆ†æ¯”)
  // å¤ªé™½ï¼šå³ä¸Šåä¸­
  setRect(el.dzSun,  70, 14, 22, 28);  // left, top, w, h
  // æœˆäº®ï¼šå³ä¸Šåä¸Š
  setRect(el.dzMoon, 72, 12, 20, 26);
  // æ˜Ÿæ˜Ÿï¼šå³ä¸Šåå·¦ä¸€é»
  setRect(el.dzStar, 60, 10, 20, 26);

  if (type === 'day'){
    el.dzSun.style.display = 'block';
    el.dzMoon.style.display = 'none';
    el.dzStar.style.display = 'none';
  } else {
    el.dzSun.style.display = 'none';
    el.dzMoon.style.display = 'block';
    el.dzStar.style.display = 'block';
  }
}

function setRect(node, leftPct, topPct, wPct, hPct){
  node.style.left = leftPct + '%';
  node.style.top = topPct + '%';
  node.style.width = wPct + '%';
  node.style.height = hPct + '%';
}

/** ===========
 * 3) æ‹–æ”¾ï¼ˆæ”¯æ´æ»‘é¼ ï¼‹è§¸æ§ï¼‰
 * ============ */
const dropzones = [el.dzSun, el.dzMoon, el.dzStar];

function getPlacedEl(type){
  if (type === 'sun') return el.placedSun;
  if (type === 'moon') return el.placedMoon;
  return el.placedStar;
}

function setToolDisabled(type){
  if (type === 'sun') el.toolSun.classList.add('disabled');
  if (type === 'moon') el.toolMoon.classList.add('disabled');
  if (type === 'star') el.toolStar.classList.add('disabled');
}

/* æ»‘é¼ /å‚³çµ± drag&drop */
document.querySelectorAll('.draggable').forEach(d => {
  d.addEventListener('dragstart', (e)=>{
    e.dataTransfer.setData('text/plain', d.dataset.type);
  });
});

dropzones.forEach(z=>{
  z.addEventListener('dragover', (e)=>{ e.preventDefault(); z.classList.add('active'); });
  z.addEventListener('dragleave', ()=> z.classList.remove('active'));
  z.addEventListener('drop', (e)=>{
    e.preventDefault();
    z.classList.remove('active');
    const type = e.dataTransfer.getData('text/plain');
    handleDrop(type, z);
  });
});

/* è§¸æ§æ‹–æ‹‰ï¼špointer events */
let pointerDrag = null; // {type, ghostEl}
document.querySelectorAll('.draggable').forEach(d=>{
  d.addEventListener('pointerdown', (e)=>{
    if (d.classList.contains('disabled')) return;
    pointerDrag = { type: d.dataset.type, ghostEl: makeGhost(d) };
    moveGhost(pointerDrag.ghostEl, e.clientX, e.clientY);
    d.setPointerCapture(e.pointerId);
  });
  d.addEventListener('pointermove', (e)=>{
    if (!pointerDrag) return;
    moveGhost(pointerDrag.ghostEl, e.clientX, e.clientY);
    const hit = hitTestDropzone(e.clientX, e.clientY);
    dropzones.forEach(z=> z.classList.toggle('active', z === hit));
  });
  d.addEventListener('pointerup', (e)=>{
    if (!pointerDrag) return;
    const hit = hitTestDropzone(e.clientX, e.clientY);
    dropzones.forEach(z=> z.classList.remove('active'));
    pointerDrag.ghostEl.remove();
    const type = pointerDrag.type;
    pointerDrag = null;
    if (hit) handleDrop(type, hit);
  });
});

function makeGhost(source){
  const g = document.createElement('div');
  g.textContent = source.textContent;
  g.style.position = 'fixed';
  g.style.left = '0px';
  g.style.top = '0px';
  g.style.transform = 'translate(-50%, -50%)';
  g.style.fontSize = '54px';
  g.style.pointerEvents = 'none';
  g.style.filter = 'drop-shadow(0 6px 6px rgba(0,0,0,.20))';
  document.body.appendChild(g);
  return g;
}
function moveGhost(g, x, y){
  g.style.left = x + 'px';
  g.style.top = y + 'px';
}

function hitTestDropzone(x, y){
  for (const z of dropzones){
    if (z.style.display === 'none') continue;
    const r = z.getBoundingClientRect();
    if (x >= r.left && x <= r.right && y >= r.top && y <= r.bottom) return z;
  }
  return null;
}

function handleDrop(type, zone){
  if (!type) return;
  const accept = zone.dataset.accept;
  // åªæ¥å—æ­£ç¢ºé¡å‹ï¼ˆé¿å…æ··äº‚ï¼‰
  if (type !== accept){
    setFeedback('bad', 'å†è©¦ä¸€æ¬¡ï¼šæŠŠæ­£ç¢ºçš„åœ–æ¡ˆæ”¾ä¸Šå»ã€‚');
    return;
  }

  // è¨­å®šå·²æ”¾ç½®
  placed[type] = true;

  // æŠŠåœ–æ¡ˆæ”¾åˆ° dropzone ä¸­å¿ƒ
  const r = zone.getBoundingClientRect();
  const cr = el.canvas.getBoundingClientRect();
  const cx = ((r.left + r.right)/2 - cr.left) / cr.width  * 100;
  const cy = ((r.top + r.bottom)/2 - cr.top) / cr.height * 100;

  const pel = getPlacedEl(type);
  pel.style.left = cx + '%';
  pel.style.top  = cy + '%';
  pel.style.display = 'block';

  // æ”¾éå°±ä¸è®“å†æ‹–ï¼ˆé™ä½èªçŸ¥è² è·ï¼‰
  setToolDisabled(type);

  clearFeedback();
}

/** ===========
 * 4) æª¢æŸ¥ç­”æ¡ˆ & æ›é¡Œ
 * ============ */
function isCorrect(){
  const q = questions[idx];
  if (q.type === 'day'){
    return placed.sun === true;
  } else {
    return placed.moon === true && placed.star === true;
  }
}

function goNext(auto=false){
  if (idx < TOTAL - 1){
    idx++;
    loadQuestion();
    if (auto) {
      // è®“å­¸ç”Ÿæœ‰ã€Œç­”å•±å³éé—œã€æ„Ÿè¦º
    }
  } else {
    // å®Œæˆ
    endScreen();
  }
}

function goPrev(){
  if (idx > 0){
    idx--;
    loadQuestion();
  }
}

function endScreen(){
  // é¡¯ç¤ºç°¡å–®å®Œæˆç•«é¢
  const pct = Math.round((correctCount / TOTAL) * 100);
  el.sceneLabel.textContent = 'å®Œæˆï¼';
  el.counter.textContent = `ä½ ç­”å°äº† ${correctCount} / ${TOTAL} é¡Œï¼ˆ${pct}%ï¼‰`;

  // æŠŠèƒŒæ™¯æ›æˆå®Œæˆç•«é¢
  const existing = el.canvas.querySelector('svg');
  if (existing) existing.remove();
  el.canvas.insertAdjacentHTML('afterbegin', svgFinish(pct));

  // éš±è— dropzones / placed
  [el.dzSun, el.dzMoon, el.dzStar].forEach(z=> z.style.display='none');
  [el.placedSun, el.placedMoon, el.placedStar].forEach(p=> p.style.display='none');

  // å·¥å…·éš±è—
  enableTools({sun:false, moon:false, star:false});
  setFeedback('ok', 'åšå¾—å¥½ï¼ä½ å®Œæˆäº†éŠæˆ²ã€‚');
}

el.btnReset.addEventListener('click', resetPlaced);

el.btnCheck.addEventListener('click', ()=>{
  if (isCorrect()){
    // è¨ˆåˆ†ï¼ˆé¿å…é‡è¤‡è¨ˆç®—ï¼šæ¯é¡Œåªè¦æŒ‰ä¸€æ¬¡ check æ‰åŠ åˆ†ï¼‰
    // æˆ‘å€‘ç”¨ feedback æ˜¯å¦å·²æ˜¯ ok ä¾†é˜²æ­¢é‡è¤‡åŠ åˆ†
    if (!el.feedback.classList.contains('ok')){
      correctCount++;
      setScore();
    }
    setFeedback('ok', 'ç­”å°äº†ï¼ä¸‹ä¸€é¡Œï½');
    // è‡ªå‹•ä¸‹ä¸€é¡Œï¼ˆ1ç§’å¾Œï¼‰
    setTimeout(()=> goNext(true), 900);
  } else {
    setFeedback('bad', 'æœªå®Œæˆï¼šå†çœ‹çœ‹ç›¸ç‰‡ï¼Œæ˜¯ç™½å¤©é‚„æ˜¯é»‘å¤œï¼Ÿ');
  }
});

el.btnPrev.addEventListener('click', goPrev);
el.btnNext.addEventListener('click', ()=> {
  // å…è¨±è€å¸«æ‰‹å‹•è·³é¡Œ
  goNext(false);
});

/** ===========
 * 5) èƒŒæ™¯ SVGï¼ˆã€Œç›¸ç‰‡æ„Ÿã€æ’ç•«ï¼‰
 * ============ */
function svgDay(seed){
  // seed ç”¨ä¾†æ›å°‘å°‘é›²ä½ç½®
  const c1 = seed % 3 === 0 ? 22 : 18;
  const c2 = seed % 2 === 0 ? 60 : 66;
  return `
  <svg viewBox="0 0 160 100" preserveAspectRatio="none" aria-hidden="true">
    <defs>
      <linearGradient id="skyDay${seed}" x1="0" x2="0" y1="0" y2="1">
        <stop offset="0" stop-color="#79c7ff"/>
        <stop offset="1" stop-color="#d7f3ff"/>
      </linearGradient>
      <linearGradient id="ground${seed}" x1="0" x2="0" y1="0" y2="1">
        <stop offset="0" stop-color="#68c46a"/>
        <stop offset="1" stop-color="#3aa74b"/>
      </linearGradient>
      <filter id="grain${seed}">
        <feTurbulence type="fractalNoise" baseFrequency=".8" numOctaves="2" stitchTiles="stitch" />
        <feColorMatrix type="saturate" values="0" />
        <feComponentTransfer>
          <feFuncA type="table" tableValues="0 0.06" />
        </feComponentTransfer>
      </filter>
    </defs>

    <rect width="160" height="100" fill="url(#skyDay${seed})"/>
    <rect y="62" width="160" height="38" fill="url(#ground${seed})"/>

    <!-- hills -->
    <path d="M0 70 C35 54, 60 86, 95 68 C120 58, 140 80, 160 70 L160 100 L0 100 Z" fill="rgba(0,0,0,.06)"/>

    <!-- clouds -->
    <g opacity=".95">
      <g transform="translate(${c1} 18)">
        <ellipse cx="10" cy="8" rx="10" ry="7" fill="#fff"/>
        <ellipse cx="20" cy="8" rx="12" ry="8" fill="#fff"/>
        <ellipse cx="30" cy="10" rx="10" ry="6" fill="#fff"/>
        <rect x="10" y="10" width="26" height="8" fill="#fff"/>
      </g>
      <g transform="translate(${c2} 10)" opacity=".9">
        <ellipse cx="10" cy="8" rx="9" ry="6" fill="#fff"/>
        <ellipse cx="18" cy="7" rx="11" ry="7" fill="#fff"/>
        <ellipse cx="28" cy="9" rx="9" ry="5" fill="#fff"/>
        <rect x="10" y="10" width="25" height="7" fill="#fff"/>
      </g>
    </g>

    <!-- subtle grain for photo-like feel -->
    <rect width="160" height="100" filter="url(#grain${seed})" opacity=".6"></rect>

    <!-- caption -->
    <text x="6" y="96" font-size="6" fill="rgba(0,0,0,.35)" font-weight="700">ç™½å¤©</text>
  </svg>`;
}

function svgNight(seed){
  const s1 = seed % 3 === 0 ? 25 : 18;
  const s2 = seed % 2 === 0 ? 78 : 68;
  return `
  <svg viewBox="0 0 160 100" preserveAspectRatio="none" aria-hidden="true">
    <defs>
      <linearGradient id="skyNight${seed}" x1="0" x2="0" y1="0" y2="1">
        <stop offset="0" stop-color="#0b1d3a"/>
        <stop offset="1" stop-color="#132a54"/>
      </linearGradient>
      <linearGradient id="groundN${seed}" x1="0" x2="0" y1="0" y2="1">
        <stop offset="0" stop-color="#264b34"/>
        <stop offset="1" stop-color="#183022"/>
      </linearGradient>
      <filter id="grainN${seed}">
        <feTurbulence type="fractalNoise" baseFrequency=".9" numOctaves="2" stitchTiles="stitch" />
        <feColorMatrix type="saturate" values="0" />
        <feComponentTransfer>
          <feFuncA type="table" tableValues="0 0.07" />
        </feComponentTransfer>
      </filter>
    </defs>

    <rect width="160" height="100" fill="url(#skyNight${seed})"/>
    <rect y="62" width="160" height="38" fill="url(#groundN${seed})"/>

    <!-- stars in background (not the draggable ones) -->
    <g opacity=".65">
      <circle cx="${s1}" cy="18" r="1.2" fill="#fff"/>
      <circle cx="${s2}" cy="22" r="1.0" fill="#fff"/>
      <circle cx="120" cy="14" r="1.1" fill="#fff"/>
      <circle cx="50" cy="28" r="0.9" fill="#fff"/>
      <circle cx="95" cy="26" r="0.8" fill="#fff"/>
      <circle cx="135" cy="30" r="0.9" fill="#fff"/>
    </g>

    <!-- hills -->
    <path d="M0 70 C35 54, 60 86, 95 68 C120 58, 140 80, 160 70 L160 100 L0 100 Z" fill="rgba(255,255,255,.06)"/>

    <rect width="160" height="100" filter="url(#grainN${seed})" opacity=".6"></rect>

    <text x="6" y="96" font-size="6" fill="rgba(255,255,255,.55)" font-weight="700">é»‘å¤œ</text>
  </svg>`;
}

function svgFinish(pct){
  return `
  <svg viewBox="0 0 160 100" preserveAspectRatio="none" aria-hidden="true">
    <defs>
      <linearGradient id="finishSky" x1="0" x2="1" y1="0" y2="1">
        <stop offset="0" stop-color="#e8f0fe"/>
        <stop offset="1" stop-color="#fff3e0"/>
      </linearGradient>
    </defs>
    <rect width="160" height="100" fill="url(#finishSky)"/>
    <text x="80" y="45" text-anchor="middle" font-size="14" fill="#1b1f2a" font-weight="900">å®Œæˆï¼</text>
    <text x="80" y="62" text-anchor="middle" font-size="10" fill="#5a6475" font-weight="800">å¾—åˆ†ï¼š${pct}%</text>
    <text x="80" y="80" text-anchor="middle" font-size="8" fill="#5a6475">åšå¾—å¥½ ğŸ‘</text>
  </svg>`;
}

/** ===========
 * 6) åˆå§‹åŒ–
 * ============ */
function shuffle(arr){
  // å¦‚æœä½ æƒ³å›ºå®šé †åºï¼Œå¯åˆªæ‰ shuffle å‘¼å«
  for (let i=arr.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
}
shuffle(questions); // æ¯æ¬¡æ‰“é–‹éƒ½æœƒéš¨æ©Ÿé¡Œç›®é †åº
setScore();
loadQuestion();
</script>
</body>
</html>
